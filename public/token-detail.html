<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Token Detail - Telegram Gateway</title>
    <link rel="stylesheet" href="/style.css" />
    <style>
      .back-button {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        padding: 10px 20px;
        background: #667eea;
        color: white;
        text-decoration: none;
        border-radius: 6px;
        font-weight: 500;
        margin-bottom: 20px;
        transition: background 0.3s;
      }
      .back-button:hover {
        background: #5568d3;
        color: white;
        text-decoration: none;
      }
      .two-column-layout {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        margin-top: 20px;
      }
      .info-card {
        background: white;
        border-radius: 8px;
        padding: 20px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      }
      .info-card h3 {
        margin-top: 0;
        color: #333;
        border-bottom: 2px solid #667eea;
        padding-bottom: 10px;
        margin-bottom: 15px;
      }
      .info-row {
        display: flex;
        padding: 10px 0;
        border-bottom: 1px solid #eee;
      }
      .info-row:last-child {
        border-bottom: none;
      }
      .info-label {
        font-weight: 600;
        width: 150px;
        color: #666;
        flex-shrink: 0;
      }
      .info-value {
        flex: 1;
        word-break: break-all;
      }
      .code-block {
        background: #f4f4f4;
        padding: 15px;
        border-radius: 6px;
        font-family: "Courier New", monospace;
        font-size: 0.9em;
        overflow-x: auto;
        margin: 10px 0;
      }
      .groups-list {
        display: grid;
        grid-template-columns: 1fr;
        gap: 15px;
        margin-top: 15px;
      }
      .group-item {
        background: #f8f9fa;
        padding: 15px;
        border-radius: 8px;
        border: 1px solid #e9ecef;
        transition: all 0.2s;
        cursor: pointer;
      }
      .group-item:hover {
        background: #e9ecef;
        border-color: #667eea;
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      }
      .group-name {
        font-weight: 600;
        font-size: 1.1em;
        color: #333;
        margin-bottom: 8px;
      }
      .group-id {
        font-family: "Courier New", monospace;
        color: #667eea;
        font-size: 0.9em;
        background: white;
        padding: 5px 10px;
        border-radius: 4px;
        display: inline-block;
      }
      .group-type {
        display: inline-block;
        padding: 4px 10px;
        border-radius: 12px;
        font-size: 0.8em;
        font-weight: 500;
        margin-top: 8px;
      }
      .group-type.group {
        background: #cfe2ff;
        color: #084298;
      }
      .group-type.private {
        background: #d1e7dd;
        color: #0f5132;
      }
      .group-type.channel {
        background: #fff3cd;
        color: #856404;
      }
      .test-section {
        background: #f8f9fa;
        padding: 20px;
        border-radius: 8px;
        margin-top: 20px;
      }
      .test-form {
        display: flex;
        gap: 10px;
        margin-top: 15px;
        flex-wrap: wrap;
      }
      .test-form input {
        flex: 1;
        min-width: 200px;
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 6px;
      }
      .test-form button {
        padding: 10px 20px;
      }
      .status-indicator {
        display: inline-block;
        width: 10px;
        height: 10px;
        border-radius: 50%;
        margin-right: 8px;
      }
      .status-online {
        background: #28a745;
      }
      .status-offline {
        background: #dc3545;
      }
      @media (max-width: 768px) {
        .two-column-layout {
          grid-template-columns: 1fr;
        }
        .groups-list {
          grid-template-columns: 1fr;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <header>
        <a href="/" class="back-button">‚Üê Kembali ke Dashboard</a>
        <h1>üìã Detail Token: <span id="tokenName">Loading...</span></h1>
      </header>

      <!-- Two Column Layout -->
      <div class="two-column-layout">
        <!-- Left Column: Bot Info -->
        <div class="info-card">
          <h3>ü§ñ Informasi Bot</h3>
          <div id="botInfo">
            <div class="loading">Memuat informasi bot...</div>
          </div>
        </div>

        <!-- Right Column: Integration Info -->
        <div class="info-card">
          <h3>üîó Informasi Integrasi</h3>
          <div class="info-row">
            <div class="info-label">Token:</div>
            <div class="info-value">
              <code id="tokenValue">-</code>
              <button
                class="btn btn-sm btn-secondary"
                onclick="copyToken()"
                style="margin-left: 10px"
              >
                Copy
              </button>
            </div>
          </div>
          <div class="info-row">
            <div class="info-label">Webhook URL:</div>
            <div class="info-value">
              <code id="webhookUrl">-</code>
            </div>
          </div>
          <div class="info-row">
            <div class="info-label">API Endpoint:</div>
            <div class="info-value">
              <code id="apiEndpoint">-</code>
            </div>
          </div>
          <div class="info-row">
            <div class="info-label">Contoh cURL:</div>
            <div class="info-value">
              <div class="code-block" id="curlExample">-</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Groups List & Message Logs (Two Column) -->
      <div class="two-column-layout" style="margin-top: 20px">
        <!-- Left Column: Groups List -->
        <div class="info-card">
          <div
            style="
              display: flex;
              justify-content: space-between;
              align-items: center;
              margin-bottom: 15px;
            "
          >
            <div>
              <h3 style="margin: 0">üí¨ Daftar Group & Chat</h3>
              <small style="color: #666; font-size: 0.85em">
                Chat akan muncul setelah bot menerima pesan
              </small>
            </div>
            <button
              class="btn btn-secondary"
              onclick="refreshChats()"
              id="refreshBtn"
            >
              üîÑ Refresh
            </button>
          </div>
          <div id="groupsList" style="max-height: 600px; overflow-y: auto">
            <div class="loading">Memuat daftar group...</div>
          </div>
        </div>

        <!-- Right Column: Message Logs -->
        <div class="info-card">
          <div
            style="
              display: flex;
              justify-content: space-between;
              align-items: center;
              margin-bottom: 15px;
            "
          >
            <h3 style="margin: 0">üìù Message Logs</h3>
            <button
              class="btn btn-secondary"
              onclick="loadMessageLogs()"
              id="refreshLogsBtn"
            >
              üîÑ Refresh
            </button>
          </div>
          <div id="messageLogsList" style="max-height: 600px; overflow-y: auto">
            <div class="loading">Memuat message logs...</div>
          </div>
        </div>
      </div>

      <!-- Test Message (Full Width) -->
      <div class="info-card" style="margin-top: 20px">
        <h3>üß™ Test Pesan</h3>
        <div class="test-section">
          <p><strong>Kirim pesan test ke chat ID tertentu:</strong></p>
          <div
            style="
              background: #e7f3ff;
              padding: 15px;
              border-radius: 6px;
              margin-bottom: 15px;
              font-size: 0.9em;
            "
          >
            <strong>üí° Cara mendapatkan Chat ID:</strong>
            <ul style="margin: 10px 0; padding-left: 20px">
              <li>
                <strong>Personal Chat:</strong> Kirim pesan /start ke bot, lalu
                cek di Message Logs di atas untuk melihat Chat ID-nya
              </li>
              <li>
                <strong>Group:</strong> Chat ID biasanya negatif (contoh:
                <code>-1001234567890</code>). Bot harus ditambahkan ke group
                dulu.
              </li>
              <li>
                <strong>Channel:</strong> Gunakan username (contoh:
                <code>@channelname</code>) atau Chat ID negatif dengan format
                <code>-100</code> di awal
              </li>
              <li>Klik group di daftar di atas untuk auto-fill Chat ID</li>
              <li style="color: #dc3545; font-weight: 600">
                ‚ö†Ô∏è <strong>PENTING:</strong> Chat ID bukan nomor HP! Nomor HP
                tidak bisa digunakan sebagai Chat ID.
              </li>
            </ul>
          </div>
          <div class="test-form">
            <input
              type="text"
              id="testChatId"
              placeholder="Chat ID (contoh: -1001234567890, 123456789) atau Username (@channelname)"
            />
            <input
              type="text"
              id="testMessage"
              placeholder="Pesan test"
              value="Hello! Ini adalah pesan test dari Telegram Gateway"
            />
            <button class="btn btn-primary" onclick="sendTestMessage()">
              Kirim
            </button>
          </div>
          <div id="testResult" style="margin-top: 15px"></div>
        </div>
      </div>
    </div>

    <script src="/token-detail.js"></script>
  </body>
</html>
